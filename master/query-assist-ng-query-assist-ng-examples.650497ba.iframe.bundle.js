(self.webpackChunk_jetbrains_ring_ui=self.webpackChunk_jetbrains_ring_ui||[]).push([[4309],{"./node_modules/@jetbrains/icons/close-12px.js":function(module){module.exports='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12"><path d="M5.997 6.784l4.454 4.359.787-.804-4.43-4.336 4.465-4.3-.78-.81-4.49 4.323L1.55.857l-.787.804 4.43 4.336-4.465 4.3.78.81 4.49-4.323z"/></svg>'},"./.storybook/angular-decorator.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{i:function(){return APP_NAME}});var angular__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/angular/index.js"),angular__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__),_storybook_preview_api__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("@storybook/preview-api");const APP_NAME="ring-ui.story.app",angularDecorator=story=>{const node=document.createElement("div");node.innerHTML=story();const app=angular__WEBPACK_IMPORTED_MODULE_0___default().bootstrap(node,[APP_NAME],{strictDi:!0});return(0,_storybook_preview_api__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>()=>{app.get("$rootScope").$destroy(),node.innerHTML=""})),node};__webpack_exports__.Z=()=>angularDecorator},"./src/query-assist-ng/query-assist-ng.examples.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{basic:function(){return basic}});var angular__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/angular/index.js"),angular__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__),_storybook_angular_decorator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./.storybook/angular-decorator.js"),_storybook_hub_config__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./.storybook/hub-config.ts"),_auth_ng_auth_ng__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/auth-ng/auth-ng.js"),_query_assist_ng__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/query-assist-ng/query-assist-ng.js");__webpack_exports__.default={title:"Legacy Angular/Query Assist Ng",decorators:[(0,_storybook_angular_decorator__WEBPACK_IMPORTED_MODULE_1__.Z)()],parameters:{storySource:{source:"import angular from 'angular';\n\nimport angularDecorator, {APP_NAME} from '../../.storybook/angular-decorator';\n\nimport hubConfig from '../../.storybook/hub-config';\n\nimport AuthNG from '../auth-ng/auth-ng';\n\nimport QueryAssistNG from './query-assist-ng';\n\nexport default {\n  title: 'Legacy Angular/Query Assist Ng',\n  decorators: [angularDecorator()],\n\n  parameters: {\n    notes: 'Provides an Angular wrapper for Query Assist.',\n    hermione: {skip: true}\n  }\n};\n\nexport const basic = ({onChange}) => {\n  angular.\n    module(APP_NAME, [QueryAssistNG, AuthNG]).\n    config(authProvider => {\n      authProvider.config(hubConfig);\n    }).\n    controller('testCtrl', function ctrl($http) {\n      this.queries = [];\n      this.query = 'query';\n      this.focus = true;\n      this.disabled = true;\n\n      this.save = ({query}) => {\n        this.queries.unshift(query);\n      };\n\n      this.change = ({query}) => {\n        this.query = query;\n        onChange('Query = ', query);\n      };\n\n      this.focusChange = ({focus}) => {\n        this.focus = focus;\n      };\n\n      this.source = ({query, caret, omitSuggestions}) => {\n        const config = {\n          params: {\n            fields: `query,caret,styleRanges${omitSuggestions ? '' : ',suggestions'}`,\n            query,\n            caret\n          }\n        };\n\n        return $http.\n          get(`${hubConfig.serverUri}/api/rest/users/queryAssist`, config).\n          then(data => data.data);\n      };\n    });\n\n  return `\n      <div ng-controller=\"testCtrl as ctrl\">\n        <button ng-click=\"ctrl.disabled = !ctrl.disabled\">Disable/Enable</button>\n\n        <div>\n          <p>{{ ctrl.query || 'no value' }}</p>\n\n          <rg-query-assist\n            x-clear=\"true\"\n            x-data-source=\"ctrl.source\"\n            x-disabled=\"ctrl.disabled\"\n            glass=\"true\"\n            focus=\"ctrl.focus\"\n            query=\"ctrl.query\"\n            on-apply=\"ctrl.save\"\n            on-change=\"ctrl.change\"\n            on-focus-change=\"ctrl.focusChange\"\n            placeholder=\"'placeholder'\"\n            hint=\"'Press ⇥ to complete first item'\"\n            hint-on-selection=\"'Press ↩ to complete selected item'\"></rg-query-assist>\n\n          <p ng-repeat=\"query in ctrl.queries track by $index\">{{ query }}</p>\n        </div>\n      </div>\n    `;\n};\n\nbasic.storyName = 'Query Assist Ng';\nbasic.argTypes = {onChange: {}};\n",locationsMap:{basic:{startLoc:{col:21,line:21},endLoc:{col:1,line:86},startBody:{col:21,line:21},endBody:{col:1,line:86}}}},notes:"Provides an Angular wrapper for Query Assist.",hermione:{skip:!0}}};const basic=_ref=>{let{onChange:onChange}=_ref;return angular__WEBPACK_IMPORTED_MODULE_0___default().module(_storybook_angular_decorator__WEBPACK_IMPORTED_MODULE_1__.i,[_query_assist_ng__WEBPACK_IMPORTED_MODULE_2__.Z,_auth_ng_auth_ng__WEBPACK_IMPORTED_MODULE_3__.Z]).config(["authProvider",authProvider=>{authProvider.config(_storybook_hub_config__WEBPACK_IMPORTED_MODULE_4__.Z)}]).controller("testCtrl",["$http",function ctrl($http){this.queries=[],this.query="query",this.focus=!0,this.disabled=!0,this.save=_ref2=>{let{query:query}=_ref2;this.queries.unshift(query)},this.change=_ref3=>{let{query:query}=_ref3;this.query=query,onChange("Query = ",query)},this.focusChange=_ref4=>{let{focus:focus}=_ref4;this.focus=focus},this.source=_ref5=>{let{query:query,caret:caret,omitSuggestions:omitSuggestions}=_ref5;const config={params:{fields:"query,caret,styleRanges"+(omitSuggestions?"":",suggestions"),query:query,caret:caret}};return $http.get(`${_storybook_hub_config__WEBPACK_IMPORTED_MODULE_4__.Z.serverUri}/api/rest/users/queryAssist`,config).then((data=>data.data))}}]),'\n      <div ng-controller="testCtrl as ctrl">\n        <button ng-click="ctrl.disabled = !ctrl.disabled">Disable/Enable</button>\n\n        <div>\n          <p>{{ ctrl.query || \'no value\' }}</p>\n\n          <rg-query-assist\n            x-clear="true"\n            x-data-source="ctrl.source"\n            x-disabled="ctrl.disabled"\n            glass="true"\n            focus="ctrl.focus"\n            query="ctrl.query"\n            on-apply="ctrl.save"\n            on-change="ctrl.change"\n            on-focus-change="ctrl.focusChange"\n            placeholder="\'placeholder\'"\n            hint="\'Press ⇥ to complete first item\'"\n            hint-on-selection="\'Press ↩ to complete selected item\'"></rg-query-assist>\n\n          <p ng-repeat="query in ctrl.queries track by $index">{{ query }}</p>\n        </div>\n      </div>\n    '};basic.storyName="Query Assist Ng",basic.argTypes={onChange:{}}},"./src/auth-ng/auth-ng.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var angular__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/angular/index.js"),angular__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__),_auth_auth__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/auth/auth.ts");const angularModule=angular__WEBPACK_IMPORTED_MODULE_0___default().module("Ring.auth",[]);angularModule.provider("auth",["$httpProvider",function provider($httpProvider){let auth;const defaultConfig={cleanHash:!1};this.init=authInstance=>{auth=authInstance},this.config=config=>{const configCopy=angular__WEBPACK_IMPORTED_MODULE_0___default().extend({},defaultConfig,config);auth=new _auth_auth__WEBPACK_IMPORTED_MODULE_1__.ZP(configCopy)},$httpProvider.interceptors.push(["$q","$injector","auth",($q,$injector,authInstance)=>{function urlEndsWith(config,suffix){return config&&config.url&&config.url.indexOf(suffix)===config.url.length-suffix.length}return{request(config){return!authInstance||urlEndsWith(config,".html")||config&&config.noAuthorization?config:authInstance.promise.then((()=>authInstance.auth.requestToken())).then((accessToken=>(accessToken&&(config.headers.Authorization=`Bearer ${accessToken}`),config)))},responseError(rejection){if(authInstance&&!urlEndsWith(rejection.config,".html")&&null!=rejection.data&&_auth_auth__WEBPACK_IMPORTED_MODULE_1__.ZP.shouldRefreshToken(rejection.data.error)){const $http=$injector.get("$http"),{data:data,method:method,params:params,url:url}=rejection.config;return authInstance.auth.forceTokenUpdate().then((()=>$http({data:data,method:method,params:params,url:url})))}return $q.reject(rejection)}}}]),this.$get=["$injector","$log","$sniffer",function get($injector,$log,$sniffer){if(!auth)return $log.warn("Auth wasn't initialized"),null;!1===auth.config.reloadOnUserChange&&auth.addListener("userChange",(()=>{$injector.get("$route").reload()}));const authInitPromise=auth.init();return authInitPromise.then((function restoreLocation(restoreLocationURL){if(restoreLocationURL){const bases=document.getElementsByTagName("base");let baseURI=auth.config.redirectUri;if(bases.length>0&&(baseURI=bases[0].href),0===restoreLocationURL.indexOf(baseURI)){const $location=$injector.get("$location");let relativeURI=restoreLocationURL.substr(baseURI.length);$location.$$html5&&!$sniffer.history&&(relativeURI=relativeURI.replace(/^#\//,"")),$location.url(relativeURI).replace()}}}),(e=>{e.authRedirect||$log.error(e)})),{auth:auth,requestUser:auth.requestUser.bind(auth),clientId:auth.config.clientId,logout:auth.logout.bind(auth),promise:authInitPromise}}]}]),__webpack_exports__.Z=angularModule.name},"./src/caret/caret.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return Caret}});var _global_dom__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/global/dom.ts");class Caret{static returnRE=/\r/g;static normalizeNewlines(value){return"string"==typeof value?value.replace(this.returnRE,""):value}target;constructor(target){this.target=target}isContentEditable(){return"true"===this.target.contentEditable}focus(){document.activeElement&&document.activeElement===this.target||this.target.focus()}getAbsolutePosition(node){let _curNode=node,curPos=0;for(;null!=_curNode&&_curNode!==this.target;){for(;_curNode.previousSibling;){var _curNode$previousSibl;curPos+=null!==(_curNode$previousSibl=_curNode.previousSibling.textContent?.length)&&void 0!==_curNode$previousSibl?_curNode$previousSibl:0,_curNode=_curNode.previousSibling}_curNode=_curNode.parentNode}return curPos}getPosition(){let params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isContentEditable()){params.avoidFocus||this.focus();const selection=window.getSelection();if(!selection?.rangeCount)return 0;const range1=selection.getRangeAt(0),range2=range1.cloneRange();range2.selectNodeContents(this.target),range2.setEnd(range1.endContainer,range1.endOffset);const _curNode=range1.startContainer;if(this.target===_curNode)return 0===range1.startOffset||null==_curNode.textContent?0:_curNode.textContent.length;if(!this.target.contains(_curNode))return-1;if(!_curNode)return"selectionStart"in this.target&&this.target.selectionStart||-1;const curPos=this.getAbsolutePosition(_curNode);if(range1.startContainer===range1.endContainer)return range1.startOffset===range1.endOffset?curPos+range1.startOffset:{startOffset:curPos+range1.startOffset,endOffset:curPos+range1.endOffset,position:range2.toString().length};return{startOffset:curPos+range1.startOffset,endOffset:this.getAbsolutePosition(range1.endContainer)+range1.endOffset,position:range2.toString().length}}return"selectionStart"in this.target&&this.target.selectionStart||-1}getRelativePosition(curNode,position){let curPos=0,_curNode=curNode;if(!_curNode)return{_curNode:this.target,_correctedPosition:position};if(0===position){for(;3!==_curNode.nodeType;)_curNode=_curNode.childNodes[0];return{_curNode:_curNode,_correctedPosition:position}}let i=-1;if(_curNode&&void 0!==_curNode.nodeType)for(;curPos<position&&3!==_curNode.nodeType&&(i++,null!=_curNode.childNodes[i]);){var _curNode$childNodes$i,_curNode$textContent$;curPos+=null!==(_curNode$childNodes$i=_curNode.childNodes[i].textContent?.length)&&void 0!==_curNode$childNodes$i?_curNode$childNodes$i:0,curPos>=position&&(_curNode=_curNode.childNodes[i],curPos-=null!==(_curNode$textContent$=_curNode.textContent?.length)&&void 0!==_curNode$textContent$?_curNode$textContent$:0,i=-1)}return{_curNode:_curNode,_correctedPosition:position-curPos}}setPosition(position){const isContentEditable=this.isContentEditable();let correctedPosition,curNode=this.target&&this.target.childNodes[0];if(void 0!==position)if("object"==typeof position){const range=new Range,start=this.getRelativePosition(curNode,position.startOffset);range.setStart(start._curNode,start._correctedPosition);const end=this.getRelativePosition(curNode,position.endOffset);range.setEnd(end._curNode,end._correctedPosition),correctedPosition=range}else if(-1===position){var _value$length;const value=isContentEditable?this.target.textContent:Caret.normalizeNewlines("value"in this.target?this.target.value:void 0);correctedPosition=null!==(_value$length=value?.length)&&void 0!==_value$length?_value$length:0}else{const{_curNode:_curNode,_correctedPosition:_correctedPosition}=this.getRelativePosition(curNode,position);curNode=_curNode,correctedPosition=_correctedPosition}if(isContentEditable){this.focus();try{correctedPosition instanceof Range?(window.getSelection()?.removeAllRanges(),window.getSelection()?.addRange(correctedPosition)):window.getSelection()?.collapse(curNode||this.target,correctedPosition)}catch(e){}}else"setSelectionRange"in this.target&&"number"==typeof correctedPosition&&this.target.setSelectionRange(correctedPosition,correctedPosition);return correctedPosition}getOffset(){let range,offset=0;try{range=window.getSelection()?.getRangeAt(0).cloneRange(),range?.setStart(range.startContainer,range.startOffset-1)}catch(e){return offset}return range&&0!==range.endOffset&&""!==range.toString()&&(offset=(0,_global_dom__WEBPACK_IMPORTED_MODULE_0__.Dz)(range).right-(0,_global_dom__WEBPACK_IMPORTED_MODULE_0__.Dz)(this.target).left-(range.startContainer instanceof HTMLElement&&range.startContainer.offsetLeft||0)),offset}}},"./src/global/angular-component-factory.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{f:function(){return createAngularComponent},Z:function(){return angular_component_factory}});var angular=__webpack_require__("./node_modules/angular/index.js"),angular_default=__webpack_require__.n(angular),react=__webpack_require__("./node_modules/react/index.js"),react_render_adapter=__webpack_require__("./src/global/react-render-adapter.js"),ring_angular_component=__webpack_require__("./src/global/ring-angular-component.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types);class Renderer extends react.Component{static propTypes={className:prop_types_default().string,nodes:prop_types_default().oneOfType([prop_types_default().array,prop_types_default().object])};componentDidMount(){const{node:node}=this,{nodes:nodes}=this.props;node&&nodes&&nodes.length&&Array.from(this.props.nodes).forEach((nodeToRender=>node.appendChild(nodeToRender)))}node;nodeRef=node=>{this.node=node};render(){const{className:className}=this.props;return react.createElement("div",{className:className,ref:this.nodeRef})}}function createAngularComponent(Component){const propKeys=Object.keys(Component.propTypes),bindings={};propKeys.forEach((key=>{bindings[key]="<"}));class AngularComponent extends ring_angular_component.Z{static bindings=bindings;static transclude=!0;$postLink(){const{$transclude:$transclude}=this.$inject;$transclude((clone=>{this.container=document.createElement("div");for(let i=0;i<clone.length;i++)this.container.appendChild(clone[i]);this.render()}))}$onChanges(){this.container&&this.render()}$onDestroy(){(0,react_render_adapter.uy)(this.$inject.$element[0])}render(){var _this=this;const{$scope:$scope,$element:{0:container}}=this.$inject,props={};propKeys.forEach((key=>{void 0!==this[key]&&("function"==typeof this[key]?props[key]=function(){const ret=_this[key](...arguments);return $scope.$applyAsync(),ret}:props[key]=this[key])}));const hasInnerContent=this.container.hasChildNodes();(0,react_render_adapter.sY)(react.createElement(Component,props,hasInnerContent?react.createElement(Renderer,{nodes:this.container.childNodes}):null),container)}}return AngularComponent.$inject=["$scope","$element","$transclude"],AngularComponent}Renderer.__docgenInfo={description:"",methods:[{name:"nodeRef",docblock:null,modifiers:[],params:[{name:"node",type:{name:"union",raw:"HTMLElement | null",elements:[{name:"HTMLElement"},{name:"null"}]}}],returns:null}],displayName:"Renderer",props:{className:{type:{name:"string"},required:!1,description:"",tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]}},nodes:{type:{name:"union",value:[{name:"array"},{name:"object"}]},required:!0,description:"",tsType:{name:"union",raw:"readonly Node[] | NodeList",elements:[{name:"unknown"},{name:"NodeList"}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/global/react-dom-renderer.tsx"]={name:"Renderer",docgenInfo:Renderer.__docgenInfo,path:"src/global/react-dom-renderer.tsx"});var angular_component_factory=function angularComponentFactory(Component,name){const angularModuleName=`Ring.${name[0].toLowerCase()+name.slice(1)}`;return angular_default().module(angularModuleName,[]).component(function getAngularComponentName(name){return`rg${name}`}(name),createAngularComponent(Component))}},"./src/global/rerender-hoc.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return rerenderHOC}});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_react_render_adapter__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/global/react-render-adapter.js"),_composeRefs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/global/composeRefs.ts");function rerenderHOC(ComposedComponent){return class Rerenderer extends ComposedComponent{_propsCache=this.props;rerender(){let container,props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},callback=arguments.length>1?arguments[1]:void 0;try{container=this.node?.parentNode}finally{if(!(container&&container instanceof Element))throw new Error(`${this.constructor.name} component isn't mounted`)}this._propsCache=Object.assign({},this.props,this._propsCache,props),this._propsCache.ref=(0,_composeRefs__WEBPACK_IMPORTED_MODULE_1__.Z)(this._propsCache.ref,callback),(0,_react_render_adapter__WEBPACK_IMPORTED_MODULE_2__.sY)((0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)(this.constructor,this._propsCache),container)}}}},"./src/global/ring-angular-component.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return RingAngularComponent}});class RingAngularComponent{static get controller(){return this}$inject={};constructor(){for(var _this$constructor$$in,_len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];(null!==(_this$constructor$$in=this.constructor.$inject)&&void 0!==_this$constructor$$in?_this$constructor$$in:[]).forEach(((injectName,i)=>{this.$inject[injectName]=args[i]}))}}},"./src/query-assist-ng/query-assist-ng.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var _global_angular_component_factory__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/global/angular-component-factory.js"),_query_assist_query_assist__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/query-assist/query-assist.tsx");__webpack_exports__.Z=(0,_global_angular_component_factory__WEBPACK_IMPORTED_MODULE_0__.Z)(_query_assist_query_assist__WEBPACK_IMPORTED_MODULE_1__.C,"QueryAssist").name},"?4f7e":function(){}}]);